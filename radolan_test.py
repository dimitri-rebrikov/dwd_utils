from radolan import RadolanProducts
from poi2RadolanRvMap import poi2RadolanRvMap
xy = poi2RadolanRvMap['70597']
xyxy = (xy[0], xy[1], xy[0], xy[1])
data = RadolanProducts.getRvData('file:./testdata/DE1200_RV2506151820.tar.bz2',{xyxy})
print(data)
assert data == {'timestamp': '2025-06-15T18:20:00Z', 'forecasts': [{'forecast': 0, 'values': {(478, 335): 5.28}}, {'forecast': 5, 'values': {(478, 335): 3.6}}, {'forecast': 10, 'values': {(478, 335): 3.96}}, {'forecast': 15, 'values': {(478, 335): 4.92}}, {'forecast': 20, 'values': {(478, 335): 4.8}}, {'forecast': 25, 'values': {(478, 335): 8.64}}, {'forecast': 30, 'values': {(478, 335): 6.72}}, {'forecast': 35, 'values': {(478, 335): 4.68}}, {'forecast': 40, 'values': {(478, 335): 1.8}}, {'forecast': 45, 'values': {(478, 335): 1.8}}, {'forecast': 50, 'values': {(478, 335): 1.68}}, {'forecast': 55, 'values': {(478, 335): 2.88}}, {'forecast': 60, 'values': {(478, 335): 4.56}}, {'forecast': 65, 'values': {(478, 335): 6.48}}, {'forecast': 70, 'values': {(478, 335): 6.0}}, {'forecast': 75, 'values': {(478, 335): 7.32}}, {'forecast': 80, 'values': {(478, 335): 5.76}}, {'forecast': 85, 'values': {(478, 335): 5.28}}, {'forecast': 90, 'values': {(478, 335): 4.08}}, {'forecast': 95, 'values': {(478, 335): 4.32}}, {'forecast': 100, 'values': {(478, 335): 4.56}}, {'forecast': 105, 'values': {(478, 335): 3.24}}, {'forecast': 110, 'values': {(478, 335): 3.0}}, {'forecast': 115, 'values': {(478, 335): 2.16}}, {'forecast': 120, 'values': {(478, 335): 1.32}}]}
